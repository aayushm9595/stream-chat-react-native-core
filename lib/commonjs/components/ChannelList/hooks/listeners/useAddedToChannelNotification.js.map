{"version":3,"sources":["useAddedToChannelNotification.ts"],"names":["useAddedToChannelNotification","onAddedToChannel","setChannels","client","handleEvent","event","channel","id","type","channels","on","off"],"mappings":";;;;;;;;;;;;;AAAA;;AACA;;AAEA;;AAEA;;AAmCO,IAAMA,6BAA6B,GAAG,SAAhCA,6BAAgC,OAWC;AAAA,MAF5CC,gBAE4C,QAF5CA,gBAE4C;AAAA,MAD5CC,WAC4C,QAD5CA,WAC4C;;AAAA,wBACzB,kCADyB;AAAA,MACpCC,MADoC,mBACpCA,MADoC;;AAG5C,wBAAU,YAAM;AACd,QAAMC,WAAW;AAAA,kFAAG,iBAAOC,KAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,sBACd,OAAOJ,gBAAP,KAA4B,UADd;AAAA;AAAA;AAAA;;AAEhBA,gBAAAA,gBAAgB,CAACC,WAAD,EAAcG,KAAd,CAAhB;AAFgB;AAAA;;AAAA;AAAA,sBAIZ,mBAAAA,KAAK,CAACC,OAAN,oCAAeC,EAAf,yBAAqBF,KAAK,CAACC,OAA3B,qBAAqB,gBAAeE,IAApC,CAJY;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAKQ,uBAAuC;AAC3DL,kBAAAA,MAAM,EAANA,MAD2D;AAE3DI,kBAAAA,EAAE,EAAEF,KAAK,CAACC,OAAN,CAAcC,EAFyC;AAG3DC,kBAAAA,IAAI,EAAEH,KAAK,CAACC,OAAN,CAAcE;AAHuC,iBAAvC,CALR;;AAAA;AAKRF,gBAAAA,OALQ;AAUdJ,gBAAAA,WAAW,CAAC,UAACO,QAAD;AAAA,yBAAc,yBAAQH,OAAR,6CAAoBG,QAApB,IAA+B,KAA/B,CAAd;AAAA,iBAAD,CAAX;;AAVc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAH;;AAAA,sBAAXL,WAAW;AAAA;AAAA;AAAA,OAAjB;;AAeAD,IAAAA,MAAM,CAACO,EAAP,CAAU,+BAAV,EAA2CN,WAA3C;AACA,WAAO;AAAA,aAAMD,MAAM,CAACQ,GAAP,CAAW,+BAAX,EAA4CP,WAA5C,CAAN;AAAA,KAAP;AACD,GAlBD,EAkBG,EAlBH;AAmBD,CAjCM","sourcesContent":["import { useEffect } from 'react';\nimport uniqBy from 'lodash/uniqBy';\n\nimport { getChannel } from '../../utils';\n\nimport { useChatContext } from '../../../../contexts/chatContext/ChatContext';\n\nimport type { Channel, Event } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n  UnknownType,\n} from '../../../../types/types';\n\ntype Parameters<\n  At extends UnknownType = DefaultAttachmentType,\n  Ch extends UnknownType = DefaultChannelType,\n  Co extends string = DefaultCommandType,\n  Ev extends UnknownType = DefaultEventType,\n  Me extends UnknownType = DefaultMessageType,\n  Re extends UnknownType = DefaultReactionType,\n  Us extends UnknownType = DefaultUserType\n> = {\n  setChannels: React.Dispatch<\n    React.SetStateAction<Channel<At, Ch, Co, Ev, Me, Re, Us>[]>\n  >;\n  onAddedToChannel?: (\n    setChannels: React.Dispatch<\n      React.SetStateAction<Channel<At, Ch, Co, Ev, Me, Re, Us>[]>\n    >,\n    event: Event<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => void;\n};\n\nexport const useAddedToChannelNotification = <\n  At extends UnknownType = DefaultAttachmentType,\n  Ch extends UnknownType = DefaultChannelType,\n  Co extends string = DefaultCommandType,\n  Ev extends UnknownType = DefaultEventType,\n  Me extends UnknownType = DefaultMessageType,\n  Re extends UnknownType = DefaultReactionType,\n  Us extends UnknownType = DefaultUserType\n>({\n  onAddedToChannel,\n  setChannels,\n}: Parameters<At, Ch, Co, Ev, Me, Re, Us>) => {\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>();\n\n  useEffect(() => {\n    const handleEvent = async (event: Event<At, Ch, Co, Ev, Me, Re, Us>) => {\n      if (typeof onAddedToChannel === 'function') {\n        onAddedToChannel(setChannels, event);\n      } else {\n        if (event.channel?.id && event.channel?.type) {\n          const channel = await getChannel<At, Ch, Co, Ev, Me, Re, Us>({\n            client,\n            id: event.channel.id,\n            type: event.channel.type,\n          });\n          setChannels((channels) => uniqBy([channel, ...channels], 'cid'));\n        }\n      }\n    };\n\n    client.on('notification.added_to_channel', handleEvent);\n    return () => client.off('notification.added_to_channel', handleEvent);\n  }, []);\n};\n"]}