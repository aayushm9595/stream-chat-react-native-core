{"version":3,"sources":["MessageList.tsx"],"names":["ListContainer","FlatList","theme","messageList","listContainer","css","keyExtractor","item","id","created_at","toISOString","date","MessageList","props","actionSheetStyles","additionalFlatListProps","AttachmentFileIcon","DateSeparator","DefaultDateSeparator","disableWhileEditing","dismissKeyboardOnMessageTouch","FooterComponent","HeaderComponent","inverted","MessageFromProps","Message","MessageNotification","DefaultMessageNotification","MessageSystem","DefaultMessageSystem","messageActions","noGroupByUser","onListScroll","onThreadSelect","setFlatListRef","threadList","NetworkDownIndicator","DefaultNetworkDownIndicator","TypingIndicator","DefaultTypingIndicator","channel","disabled","EmptyStateIndicator","loading","LoadingIndicator","markRead","client","isOnline","clearEditingState","editing","mainLoadMore","loadMore","MessageFromContext","loadMoreThread","flatListRef","yOffset","lastReceivedId","setLastReceivedId","newMessagesNotification","setNewMessageNotification","messagesLoading","setMessagesLoading","currentLastMessage","currentLastReceivedId","hasNewMessage","userScrolledUp","current","isOwner","user","userID","scrollToBottom","scrollToIndex","index","renderItem","message","type","groupStyles","undefined","readBy","handleScroll","event","y","nativeEvent","contentOffset","removeNewMessageNotification","countUnread","goToNewMessages","length","flex","alignItems","width","autoscrollToTopThreshold","minIndexForVisible","fl","backgroundColor","height","opacity","position","zIndex"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport {\n  FlatList,\n  FlatListProps,\n  ScrollViewProps,\n  TouchableOpacity,\n  View,\n} from 'react-native';\n\nimport {\n  DateSeparatorProps,\n  DateSeparator as DefaultDateSeparator,\n} from './DateSeparator';\nimport {\n  MessageNotification as DefaultMessageNotification,\n  MessageNotificationProps,\n} from './MessageNotification';\nimport {\n  MessageSystem as DefaultMessageSystem,\n  MessageSystemProps,\n} from './MessageSystem';\nimport {\n  TypingIndicator as DefaultTypingIndicator,\n  TypingIndicatorProps,\n} from './TypingIndicator';\nimport { TypingIndicatorContainer } from './TypingIndicatorContainer';\n\nimport { useMessageList } from './hooks/useMessageList';\nimport { getLastReceivedMessage } from './utils/getLastReceivedMessage';\nimport { isDateSeparator, MessageOrDate } from './utils/insertDates';\n\nimport { Message as DefaultMessage } from '../Message/Message';\n\nimport { useChannelContext } from '../../contexts/channelContext/ChannelContext';\nimport { useChatContext } from '../../contexts/chatContext/ChatContext';\nimport {\n  GroupType,\n  useMessagesContext,\n} from '../../contexts/messagesContext/MessagesContext';\nimport {\n  ThreadContextValue,\n  useThreadContext,\n} from '../../contexts/threadContext/ThreadContext';\nimport { styled } from '../../styles/styledComponents';\n\nimport type { UserResponse } from 'stream-chat';\n\nimport type { FileIconProps } from '../Attachment/FileIcon';\nimport type { ActionSheetStyles } from '../Message/MessageSimple/MessageActionSheet';\nimport type { MessageSimpleProps } from '../Message/MessageSimple/MessageSimple';\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n  UnknownType,\n} from '../../types/types';\n\nimport { NetworkDownIndicator as DefaultNetworkDownIndicator } from './NetworkDownIndicator';\nimport { generateRandomId } from '../../utils/generateRandomId';\n\nconst ListContainer = (styled(FlatList)`\n  flex: 1;\n  padding-horizontal: 10px;\n  width: 100%;\n  ${({ theme }) => theme.messageList.listContainer.css}\n` as React.ComponentType) as new <T>() => FlatList<T>;\n\nconst keyExtractor = <\n  At extends UnknownType = DefaultAttachmentType,\n  Ch extends UnknownType = DefaultChannelType,\n  Co extends string = DefaultCommandType,\n  Ev extends UnknownType = DefaultEventType,\n  Me extends UnknownType = DefaultMessageType,\n  Re extends UnknownType = DefaultReactionType,\n  Us extends UnknownType = DefaultUserType\n>(\n  item: MessageOrDate<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  if (!isDateSeparator(item)) {\n    return (\n      item.id ||\n      (item.created_at\n        ? typeof item.created_at === 'string'\n          ? item.created_at\n          : item.created_at.toISOString()\n        : generateRandomId())\n    );\n  }\n  if (item.date && typeof item.date !== 'string') {\n    return item.date.toISOString();\n  }\n  return generateRandomId();\n};\n\nexport type MessageListProps<\n  At extends UnknownType = DefaultAttachmentType,\n  Ch extends UnknownType = DefaultChannelType,\n  Co extends string = DefaultCommandType,\n  Ev extends UnknownType = DefaultEventType,\n  Me extends UnknownType = DefaultMessageType,\n  Re extends UnknownType = DefaultReactionType,\n  Us extends UnknownType = DefaultUserType\n> = {\n  /**\n   * Style object for action sheet (used to message actions).\n   * Supported styles: https://github.com/beefe/react-native-actionsheet/blob/master/lib/styles.js\n   */\n  actionSheetStyles?: ActionSheetStyles;\n  /**\n   * Besides existing (default) UX behavior of underlying FlatList of MessageList component, if you want\n   * to attach some additional props to underlying FlatList, you can add it to following prop.\n   *\n   * You can find list of all the available FlatList props here - https://facebook.github.io/react-native/docs/flatlist#props\n   *\n   * **NOTE** Don't use `additionalFlatListProps` to get access to ref of flatlist. Use `setFlatListRef` instead.\n   *\n   * e.g.\n   * ```js\n   * <MessageList\n   *  additionalFlatListProps={{ bounces: true, keyboardDismissMode: true }} />\n   * ```\n   */\n  additionalFlatListProps?: Partial<\n    FlatListProps<MessageOrDate<At, Ch, Co, Ev, Me, Re, Us>>\n  >;\n  /**\n   * Custom UI component for attachment icon for type 'file' attachment.\n   * Defaults to: https://github.com/GetStream/stream-chat-react-native/blob/master/src/components/Attachment/FileIcon.tsx\n   */\n  AttachmentFileIcon?: React.ComponentType<FileIconProps>;\n  /**\n   * Date separator UI component to render\n   *\n   * Defaults to and accepts same props as: [DateSeparator](https://getstream.github.io/stream-chat-react-native/#dateseparator)\n   */\n  DateSeparator?: React.ComponentType<\n    DateSeparatorProps<At, Ch, Co, Ev, Me, Re, Us>\n  >;\n  disableWhileEditing?: boolean;\n  /** Should keyboard be dismissed when messaged is touched */\n  dismissKeyboardOnMessageTouch?: boolean;\n  /**\n   * UI component for header of message list. By default message list doesn't have any header.\n   * This is basically a [ListFooterComponent](https://facebook.github.io/react-native/docs/flatlist#listheadercomponent) of FlatList\n   * used in MessageList. Its footer instead of header, since message list is inverted.\n   *\n   */\n  FooterComponent?: React.ReactElement;\n  HeaderComponent?: React.ReactElement;\n  /** Whether or not the FlatList is inverted. Defaults to true */\n  inverted?: boolean;\n  /**\n   * Custom UI component to display a message in MessageList component\n   * Default component (accepts the same props): [MessageSimple](https://getstream.github.io/stream-chat-react-native/#messagesimple)\n   */\n  Message?: React.ComponentType<MessageSimpleProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  /**\n   * Array of allowed actions on message. e.g. ['edit', 'delete', 'reactions', 'reply']\n   * If all the actions need to be disabled, empty array or false should be provided as value of prop.\n   */\n  messageActions?: boolean | string[];\n  MessageNotification?: React.ComponentType<MessageNotificationProps>;\n  /**\n   * Custom UI component to display a system message\n   * Default component (accepts the same props): [MessageSystem](https://getstream.github.io/stream-chat-react-native/#messagesystem)\n   */\n  MessageSystem?: React.ComponentType<\n    MessageSystemProps<At, Ch, Co, Ev, Me, Re, Us>\n  >;\n  /**\n   * Custom UI component to render network down indicator\n   *\n   * Defaults to and accepts same props as: [NetworkDownIndicator](https://getstream.github.io/stream-chat-react-native/#NetworkDownIndicator)\n   */\n  NetworkDownIndicator?: React.ComponentType;\n  /** Turn off grouping of messages by user */\n  noGroupByUser?: boolean;\n  onListScroll?: ScrollViewProps['onScroll'];\n  /**\n   * Handler to open the thread on message. This is callback for touch event for replies button.\n   *\n   * @param message A message object to open the thread upon.\n   */\n  onThreadSelect?: (\n    message: ThreadContextValue<At, Ch, Co, Ev, Me, Re, Us>['thread'],\n  ) => void;\n  /**\n   * Use `setFlatListRef` to get access to ref to inner FlatList.\n   *\n   * e.g.\n   * ```js\n   * <MessageList\n   *  setFlatListRef={(ref) => {\n   *    // Use ref for your own good\n   *  }}\n   * ```\n   */\n  setFlatListRef?: (\n    ref: FlatList<MessageOrDate<At, Ch, Co, Ev, Me, Re, Us>> | null,\n  ) => void;\n  /** Whether or not the MessageList is part of a Thread */\n  threadList?: boolean;\n  /**\n   * Typing indicator UI component to render\n   *\n   * Defaults to and accepts same props as: [TypingIndicator](https://getstream.github.io/stream-chat-react-native/#typingindicator)\n   */\n  TypingIndicator?: React.ComponentType<TypingIndicatorProps>;\n};\n\n/**\n * The message list component renders a list of messages. It consumes the following contexts:\n *\n * [ChannelContext](https://getstream.github.io/stream-chat-react-native/#channelcontext)\n * [ChatContext](https://getstream.github.io/stream-chat-react-native/#chatcontext)\n * [MessagesContext](https://getstream.github.io/stream-chat-react-native/#messagescontext)\n * [ThreadContext](https://getstream.github.io/stream-chat-react-native/#threadcontext)\n * [TranslationContext](https://getstream.github.io/stream-chat-react-native/#translationcontext)\n *\n * @example ./MessageList.md\n */\nexport const MessageList = <\n  At extends UnknownType = DefaultAttachmentType,\n  Ch extends UnknownType = DefaultChannelType,\n  Co extends string = DefaultCommandType,\n  Ev extends UnknownType = DefaultEventType,\n  Me extends UnknownType = DefaultMessageType,\n  Re extends UnknownType = DefaultReactionType,\n  Us extends UnknownType = DefaultUserType\n>(\n  props: MessageListProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    actionSheetStyles,\n    additionalFlatListProps,\n    AttachmentFileIcon,\n    DateSeparator = DefaultDateSeparator,\n    disableWhileEditing = true,\n    dismissKeyboardOnMessageTouch = true,\n    FooterComponent,\n    HeaderComponent,\n    inverted = true,\n    Message: MessageFromProps,\n    MessageNotification = DefaultMessageNotification,\n    MessageSystem = DefaultMessageSystem,\n    messageActions,\n    noGroupByUser,\n    onListScroll,\n    onThreadSelect,\n    setFlatListRef,\n    threadList,\n    NetworkDownIndicator = DefaultNetworkDownIndicator,\n    TypingIndicator = DefaultTypingIndicator,\n  } = props;\n\n  const {\n    channel,\n    disabled,\n    EmptyStateIndicator,\n    loading,\n    LoadingIndicator,\n    markRead,\n  } = useChannelContext<At, Ch, Co, Ev, Me, Re, Us>();\n  const { client, isOnline } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>();\n  const {\n    clearEditingState,\n    editing,\n    loadMore: mainLoadMore,\n    Message: MessageFromContext,\n  } = useMessagesContext<At, Ch, Co, Ev, Me, Re, Us>();\n  const { loadMoreThread } = useThreadContext<At, Ch, Co, Ev, Me, Re, Us>();\n\n  const messageList = useMessageList<At, Ch, Co, Ev, Me, Re, Us>({\n    inverted,\n    noGroupByUser,\n    threadList,\n  });\n\n  const flatListRef = useRef<FlatList<\n    MessageOrDate<At, Ch, Co, Ev, Me, Re, Us>\n  > | null>(null);\n  const yOffset = useRef(0);\n\n  const [lastReceivedId, setLastReceivedId] = useState(\n    getLastReceivedMessage(messageList)?.id,\n  );\n  const [newMessagesNotification, setNewMessageNotification] = useState(false);\n\n  /**\n   * In order to prevent the LoadingIndicator component from showing up briefly on mount,\n   * we set the loading state one cycle behind to ensure the messages are set before the\n   * change to the loading state is registered.\n   */\n  const [messagesLoading, setMessagesLoading] = useState(false);\n  useEffect(() => {\n    setMessagesLoading(!!loading);\n  }, [loading]);\n\n  useEffect(() => {\n    const currentLastMessage = getLastReceivedMessage(messageList);\n    if (currentLastMessage) {\n      const currentLastReceivedId = currentLastMessage.id;\n      if (currentLastReceivedId) {\n        const hasNewMessage = lastReceivedId !== currentLastReceivedId;\n        const userScrolledUp = yOffset.current > 0;\n        const isOwner =\n          currentLastMessage &&\n          client &&\n          currentLastMessage.user?.id === client.userID;\n\n        // always scroll down when it's your own message that you added..\n        const scrollToBottom = hasNewMessage && (isOwner || !userScrolledUp);\n\n        // Check the scroll position... if you're scrolled up show a little notification\n        if (!scrollToBottom && hasNewMessage && !newMessagesNotification) {\n          setNewMessageNotification(true);\n        }\n\n        // remove the scroll notification when we scroll down...\n        if (scrollToBottom && flatListRef.current) {\n          flatListRef.current.scrollToIndex({ index: 0 });\n          setNewMessageNotification(false);\n        }\n\n        if (hasNewMessage) setLastReceivedId(currentLastReceivedId);\n      }\n    }\n  }, [messageList]);\n\n  const loadMore = threadList ? loadMoreThread : mainLoadMore;\n\n  const Message = MessageFromProps || MessageFromContext;\n\n  const renderItem = (message: MessageOrDate<At, Ch, Co, Ev, Me, Re, Us>) => {\n    if (isDateSeparator(message)) {\n      return <DateSeparator message={message} />;\n    }\n    if (message.type === 'system') {\n      return <MessageSystem message={message} />;\n    }\n    if (message.type !== 'message.read') {\n      return (\n        <DefaultMessage<At, Ch, Co, Ev, Me, Re, Us>\n          actionSheetStyles={actionSheetStyles}\n          AttachmentFileIcon={AttachmentFileIcon}\n          dismissKeyboardOnMessageTouch={dismissKeyboardOnMessageTouch}\n          groupStyles={message.groupStyles as GroupType[]}\n          lastReceivedId={\n            lastReceivedId === message.id ? lastReceivedId : undefined\n          }\n          Message={Message}\n          message={message}\n          messageActions={messageActions}\n          onThreadSelect={onThreadSelect}\n          readBy={(message.readBy as UserResponse<Us>[]) || []}\n          threadList={threadList}\n        />\n      );\n    }\n    return null;\n  };\n\n  const handleScroll: ScrollViewProps['onScroll'] = (event) => {\n    const y = event.nativeEvent.contentOffset.y;\n    const removeNewMessageNotification = y <= 0;\n    if (\n      !threadList &&\n      removeNewMessageNotification &&\n      channel &&\n      channel.countUnread() > 0\n    ) {\n      markRead();\n    }\n\n    yOffset.current = y;\n    if (removeNewMessageNotification) {\n      setNewMessageNotification(false);\n    }\n    if (onListScroll) {\n      onListScroll(event);\n    }\n  };\n\n  const goToNewMessages = () => {\n    if (flatListRef.current) {\n      flatListRef.current.scrollToIndex({ index: 0 });\n      setNewMessageNotification(false);\n      if (!threadList) markRead();\n    }\n  };\n\n  // We can't provide ListEmptyComponent to FlatList when inverted flag is set.\n  // https://github.com/facebook/react-native/issues/21196\n  if (messageList.length === 0 && !threadList) {\n    return messagesLoading ? (\n      <LoadingIndicator listType='message' />\n    ) : (\n      <View style={{ flex: 1 }} testID='empty-state'>\n        <EmptyStateIndicator listType='message' />\n      </View>\n    );\n  }\n\n  return (\n    <>\n      <View\n        collapsable={false}\n        style={{ alignItems: 'center', flex: 1, width: '100%' }}\n      >\n        <ListContainer\n          data={messageList}\n          /** Disables the MessageList UI. Which means, message actions, reactions won't work. */\n          extraData={disabled}\n          inverted={inverted}\n          keyboardShouldPersistTaps='always'\n          keyExtractor={keyExtractor}\n          ListFooterComponent={FooterComponent}\n          ListHeaderComponent={HeaderComponent}\n          maintainVisibleContentPosition={{\n            autoscrollToTopThreshold: 10,\n            minIndexForVisible: 1,\n          }}\n          onEndReached={loadMore}\n          onScroll={handleScroll}\n          ref={(fl) => {\n            flatListRef.current = fl;\n            if (setFlatListRef) {\n              setFlatListRef(fl);\n            }\n          }}\n          renderItem={({ item }) => renderItem(item)}\n          testID='message-flat-list'\n          {...additionalFlatListProps}\n        />\n        {TypingIndicator && (\n          <TypingIndicatorContainer<At, Ch, Co, Ev, Me, Re, Us>>\n            <TypingIndicator />\n          </TypingIndicatorContainer>\n        )}\n        {newMessagesNotification && (\n          <MessageNotification\n            onPress={goToNewMessages}\n            showNotification={newMessagesNotification}\n          />\n        )}\n        {!isOnline && <NetworkDownIndicator />}\n      </View>\n      {\n        // Mask for edit state\n        editing && disableWhileEditing && (\n          <TouchableOpacity\n            onPress={clearEditingState}\n            style={{\n              backgroundColor: 'black',\n              height: '100%',\n              opacity: 0.4,\n              position: 'absolute',\n              width: '100%',\n              zIndex: 100,\n            }}\n          />\n        )\n      }\n    </>\n  );\n};\n"]}